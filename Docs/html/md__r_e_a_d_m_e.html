<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Exiled: EXILED - EXtended In-runtime Library for External Development</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Exiled
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EXILED - EXtended In-runtime Library for External Development </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="https://github.com/galaxy119/EXILED/workflows/EXILED%20CI/badge.svg?branch=2.0.0" alt="EXILED CI" style="pointer-events: none;" class="inline"/> <img src="https://img.shields.io/github/release/galaxy119/EXILED/all.svg?style=flat" alt="GitHub Release" style="pointer-events: none;" class="inline"/> <img src="https://img.shields.io/github/downloads/galaxy119/EXILED/total.svg?style=flat" alt="Github All Releases" style="pointer-events: none;" class="inline"/> <a href="https://discord.gg/PyUkWTg"><img src="https://img.shields.io/discord/656673194693885975?logo=discord" alt="Chat on Discord" class="inline"/> </a></p>
<p>EXILED is a low-level plugin framework for SCP: Secret Laboratory servers. It offers an event system for developers to hook in order to manipulate or change game code, or implement their own functions. All EXILED events are coded with Harmony, meaning they require no direct editing of server Assemblies to function, which allows for two unique benefits.</p>
<ul>
<li>Firstly, the entirety of the frameworks code can be freely published and shared, allowing developers to better understand <em>how</em> it works, as well as offer suggestions for adding to or changing it's features.</li>
<li>Secondly, since all of the code related to the framework are done outside of the server assembly, things like small game updates will have little, if any, effect on the framework. Making it most likely to be compatible with future game updates, as well as making it easier to update when it <em>is</em> necessary to do so.</li>
</ul>
<h1><a class="anchor" id="autotoc_md13"></a>
Installation</h1>
<p>Installation of EXILED may seem more involved or complicated than other frameworks, but it is in fact quite simple. As mentioned above, the vast majority of EXILED is not contained within the server's Assembly-CSharp.dll file, however, there is a single modification needed to the Assembly-CSharp.dll file that is required to actually <em>load</em> EXILED into the server during startup, a clean game Assembly with this change already made will be provided with releases.</p>
<ul>
<li>Click on the "Release" tab near the top-right, and download the latest release version of the framework. You can choose the automated <code>Exiled.Installer.exe</code>, or you can follow the directions below to install the framework manually, either is acceptable.</li>
<li>If choosing to use the Installer.exe, simply run the .exe to install EXILED. If you are installing EXILED on a remote server, make sure you run the .exe as the same user that runs your SCP: SL servers. (Linux server owners can still use the .exe, simply run it in a terminal with <code>mono Exiled.Installer.exe</code>). The installer will, if run correctly, take care of installing <code><a class="el" href="namespace_exiled_1_1_loader.html">Exiled.Loader</a></code>, <code><a class="el" href="namespace_exiled_1_1_updater.html">Exiled.Updater</a></code>, <code><a class="el" href="namespace_exiled_1_1_permissions.html">Exiled.Permissions</a></code>, <code><a class="el" href="namespace_exiled_1_1_a_p_i.html">Exiled.API</a></code> and <code><a class="el" href="namespace_exiled_1_1_events.html">Exiled.Events</a></code>, and ensuring your server has the proper Assembly-CSharp.dll file installer. If you are on a Windows server, or have a non-standard scp_server installation folder (default is <code>/home/scp/scp_server</code>) you can run the .exe in a Command Prompt/Terminal and specify your server's install directory. EX: <code>mono Exiled.Installer.exe /home/scp/server</code>(or just <code>Exiled.Installer.exe path\to\server\folder</code> for Windows).</li>
</ul>
<p>If you choose to install EXILED manually:</p><ul>
<li>Ensure you are logged in on the user that runs the SCP servers.<ul>
<li>Download the EXILED.tar.gz archive from the latest release, and extract it's contents to a folder on the machine you will be installing EXILED on. (Windows users will need a 3rd party tool such as 7zip to do this) <em>Linux command line: <code>tar -xzvf EXILED.tar.gz</code></em></li>
<li>Move the included <code>Assembly-CSharp.dll</code> file into the <code>SCPSL_Data/Managed</code> folder of your server installation. (Replace the existing file).</li>
<li>Navigate to <code>~/.config</code> (<code>AppData%</code> on Windows), and move both the "EXILED" folder that were provided in the above mentioned archive into this location *Note: These 2 folders need to go in <code>~/.config</code>, and <em><b>NOT</b></em> <code>~/.config/SCP Secret Laboratory</code></li>
<li>That's it, EXILED should now be installed and active the next time you boot up your server. It should be noted, that EXILED by themselves will do almost nothing, you must have plugins installed in order to use EXILED. Plugin .dll files go into the <code>Plugins</code> folder that should now be located at <code>~/.config/EXILED/Plugins</code> (<code>AppData%\EXILED\Plugins</code> on Windows).</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Config</h1>
<p>EXILED by itself offers some config options. All of them are auto-generated at the server startup, they are located at <code>~/.config/EXILED/Configs/(ServerPortHere)-config.yml</code> file (<code>AppData%\EXILED\Configs\(ServerPortHere)-config.yml</code> on Windows).</p>
<p>Plugin configs will <em><b>NOT</b></em> be in the aforementioned <code>config_gameplay.txt</code> file, instead, plugin configs are set in the <code>~/.config/EXILED/Configs/(ServerPortHere)-config.yml</code> file (<code>AppData%\EXILED\(ServerPortHere)-config.yml</code> on Windows). However, some plugins might get their config settings from other locations on their own, this is simply the default EXILED location for them, so refer to the individual plugin if there are issues.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
For Developers</h1>
<p>If you wish to make a Plugin for EXILED, it's quite simple to do so. If you would like more of a tutorial please visit our <a href="https://github.com/galaxy119/EXILED/blob/master/GettingStarted.md">Getting Started Page.</a>, or you can just watch a <a href="https://www.youtube.com/watch?v=gx67ziYldvk">video tutorial</a> on YouTube.</p>
<p>But make sure to follow these rules when publishing your plugins:</p>
<ul>
<li>Your plugin must contain a class that inherits from Exiled.API.Features.Plugin&lt;&gt;, if it does not, EXILED will not load your plugin when the server starts.</li>
<li>When a plugin is loaded, the code within the aforementioned class' <code>OnEnabled()</code> method is fired immediately, it does not wait for other plugins to be loaded. It does not wait for the server startup process to finish. <em><b>It does not wait for anything.</b></em> When setting up your OnEnable() method, be sure you are not accessing things which may not be initialized by the server yet, such as ServerConsole.Port, or PlayerManager.localPlayer.</li>
<li>If you need to access things early on that are not initialized before your plugin is loaded, it is recommended to simply wait for the WaitingForPlayers event to do so, if you for some reason need to do things sooner, wrap the code in a <code>while(!x)</code> loop that checks for the variable/object you need to no longer be null before continuing.</li>
<li>EXILED supports dynamically reloading plugin assemblies mid-execution. The means that, if you need to update a plugin, it can be done without rebooting the server, however, if you are updating a plugin mid-execution, the plugin needs to be properly setup to support it, or you will have a very bad time. Refer to the <code>Dynamic Updates</code> section for more information and guidelines to follow.</li>
<li>There is <em><b>NO</b></em> OnUpdate, OnFixedUpdate or OnLateUpdate event within EXILED. If you need to, for some reason, run code that often, you can use a MEC coroutine that waits for one frame, 0.01f, or uses a Timing layer like Timing.FixedUpdate instead.</li>
</ul>
<h3><a class="anchor" id="autotoc_md16"></a>
Disabling EXILED Event patches</h3>
<p><em><b>This feature is currently no longer implemented.</b></em></p>
<h3><a class="anchor" id="autotoc_md17"></a>
MEC Coroutines</h3>
<p>If you are unfamiliar with MEC, this will be a very brief and simple primer to get you started. MEC Coroutines are basically timed methods, that support waiting periods of time before continuing execution, without interrupting/sleeping the main game thread. MEC coroutines are safe to use with Unity, unlike traditional threading. <em><b>DO NOT try and make new threads to interact with Unity on, they WILL crash the server.</b></em></p>
<p>To use MEC, you will need to reference <code>Assembly-CSharp-firstpass.dll</code> from the server files, and include <code>using MEC;</code>. Example of calling a simple coroutine, that repeats itself with a delay between each loop: </p><div class="fragment"><div class="line"><span class="keyword">using</span> MEC;</div>
<div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> SomeMethod()</div>
<div class="line">{</div>
<div class="line">    Timing.RunCoroutine(MyCoroutine());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> IEnumerator&lt;float&gt; MyCoroutine()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span>(;;) <span class="comment">//repeat the following infinitely</span></div>
<div class="line">    {</div>
<div class="line">        Plugin.Info(<span class="stringliteral">&quot;Hey I&#39;m a infinite loop!&quot;</span>); <span class="comment">//Call Plugin.Info to print a line to the game console/server logs</span></div>
<div class="line">        yield <span class="keywordflow">return</span> Timing.WaitForSecond(5f); <span class="comment">//Tells the coroutine to wait 5 seconds before continuing, since this is at the end of the loop, it effectively stalls the loop from repeating for 5seconds.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>It is <em><b>strongly</b></em> recommended that you do some googling, or ask around in the Discord if you are unfamiliar with MEC and would like to learn more, get advice, or need help. Questions, no matter how 'stupid' they are, will always be answered as helpfully and clearly as possible for plugin developers to excell. Better code is better for everyone.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
Dynamic Updates</h3>
<p>EXILED as a framework supports dynamic reloading of plugin assemblies without requiring a server reboot. For example, if you start the server with just <code><a class="el" href="namespace_exiled_1_1_events.html">Exiled.Events</a></code> as the only plugin, and wish to add a new one, you do not need to reboot the server to complete this task. You can simply use the RemoteAdmin/ServerConsole command <code>reload plugins</code> to reload all EXILED plugins, including new ones that weren't loaded before.</p>
<p>This also means that you can <em>update</em> plugins without having to fully reboot the server as well. However there are a few guidelines that must be followed by the plugin developer in order for this to be achieved properly:</p>
<p><em><b>For Hosts</b></em></p><ul>
<li>If you are updating a plugin, make sure that it's assembly name is not the same as the current version you have installed (if any). The plugin must be built by the developer with Dynamic Updates in mind for this to work, simply renaming the file will not.</li>
<li>If the plugin supports Dynamic Updates, be sure that when you put the newer version of the plugin into the "Plugins" folder, you also remove the older version from the folder, before reloading EXILED, failure to ensure this will result in many many bad things.</li>
<li>Any problems that arise from Dynamically Updating a plugin is solely the responsibility of you and the developer of the plugin in question. While EXILED fully supports and encourages Dynamic Updates, the only way it could fail or go wrong is if the server host or plugin dev did something wrong. Triple check that everything was done correctly by both of those parties before reporting a bug to EXILED devs regarding Dynamic Updates.</li>
</ul>
<p><em><b>For Developers</b></em></p>
<ul>
<li>Plugins that want to support Dynamic Updating need to be sure to unsubscribe from all events they are hooked into when they are Disabled or Reloaded.</li>
<li>Plugins that have custom Harmony patches must use some kind of changing variable within the name of the Harmony Instance, and must UnPatchAll() on their harmony instance when the plugin is disabled or reloaded.</li>
<li>Any coroutines started by the plugin in OnEnabled must also be killed when the plugin is disabled or reloaded.</li>
</ul>
<p>All of these can be achieved in either the OnReloaded() or OnDisabled() methods in the plugin class. When EXILED reloads plugins, it calls OnDisabled(), then OnReloaded(), then it will load in the new assemblies, and then executes OnEnabled().</p>
<p>Note that I said <em>new</em> assemblies. If you replace an assembly with another one of the same name, it will <em><b>NOT</b></em> be updated. This is due to the GAC (Global Assembly Cache), if you attempt to 'load' and assembly that is already in the cache, it will always use the cached assembly instead. For this reason, if your plugin will support Dynamic Updates, you must build each version with a different Assembly Name in the build options (renaming the file will not work). Also, since the old assembly is not "destroyed" when it is no longer needed, if you fail to unsubscribe from events, unpatch your harmony instance, kill coroutines, etc, that code will continue to run aswell as the new version's code. This is a very very bad idea to let happen.</p>
<p>As such, plugins that support Dynamic Updates <em><b>MUST</b></em> follow these guidelines or they will be removed from the Discord server due to potential risk to server hosts.</p>
<p>But not every plugin must support Dynamic Updates. If you do not intend to support Dynamic Updates, that's perfectly fine, simply don't change the Assembly Name of your plugin when you build a new version, and you will not need to worry about any of this, just make sure server hosts know they will need to completely reboot their servers to update your plugin. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
